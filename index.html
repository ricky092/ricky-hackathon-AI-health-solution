<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mood Journal - AI-Powered Emotion Tracker</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
     body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f7fa;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    header h1 {
      color: #4e73df;
      margin-bottom: 10px;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }
    nav a {
      text-decoration: none;
      color: #4e73df;
      font-weight: 500;
      padding: 8px 16px;
      border-radius: 20px;
      transition: all 0.3s;
    }
    nav a:hover, nav a.active {
      background-color: #4e73df;
      color: white;
    }
    .journal-container, .history-container {
      margin-bottom: 30px;
    }
    #journal-form {
      margin-bottom: 30px;
    }
    #journal-entry {
      width: 100%;
      min-height: 200px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-family: inherit;
      font-size: 16px;
      margin-bottom: 15px;
      resize: vertical;
    }
    button {
      background-color: #4e73df;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #3a56c4;
    }
    .hidden {
      display: none;
    }
    #result {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }
    .entries-list {
      margin-top: 30px;
    }
    .journal-entry {
      border: 1px solid #eee;
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .entry-date {
      font-weight: bold;
      color: #666;
      margin-bottom: 10px;
    }
    .entry-sentiment {
      margin-top: 10px;
      font-style: italic;
      color: #4e73df;
    }
    .chart-container {
      height: 300px;
      margin-bottom: 30px;
    }
    .emotion-tag {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      background-color: #4e73df;
      color: white;
      margin-right: 8px;
    }
    .loading {
      text-align: center;
      padding: 20px;
    }
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #4e73df;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Mood Journal</h1>
      <p>Track your emotions with AI-powered analysis</p>
    </header>
    <nav>
      <a href="#" class="active" id="nav-new">New Entry</a>
      <a href="#" id="nav-history">History</a>
    </nav>
    <main>
      <!-- New Entry Section -->
      <div id="journal-section">
        <div class="journal-container">
          <h2>How are you feeling today?</h2>
          <form id="journal-form">
            <textarea id="journal-entry" name="journal_entry" placeholder="Write about your day, your feelings, or anything on your mind..." required></textarea>
            <button type="submit">Analyze My Emotions</button>
          </form>
          <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <p>Analyzing your emotions...</p>
          </div>
          <div id="result" class="hidden">
            <h3>Emotion Analysis</h3>
            <p>Your entry expresses: <span id="emotion-label" class="emotion-tag"></span> with <span id="emotion-score"></span> confidence</p>
            <div class="chart-container">
              <canvas id="emotion-chart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <!-- History Section -->
      <div id="history-section" class="history-container hidden">
        <h2>Your Journal History</h2>
        <div class="chart-container">
          <canvas id="mood-trend-chart"></canvas>
        </div>
        <div class="entries-list" id="entries-list">
          <p>No entries yet. <a href="#" id="start-journal">Write your first journal entry</a>.</p>
        </div>
      </div>
    </main>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation
      const navNew = document.getElementById('nav-new');
      const navHistory = document.getElementById('nav-history');
      const journalSection = document.getElementById('journal-section');
      const historySection = document.getElementById('history-section');
      const startJournalLink = document.getElementById('start-journal');
      navNew.addEventListener('click', function(e) {
        e.preventDefault();
        journalSection.classList.remove('hidden');
        historySection.classList.add('hidden');
        navNew.classList.add('active');
        navHistory.classList.remove('active');
      });
      navHistory.addEventListener('click', function(e) {
        e.preventDefault();
        journalSection.classList.add('hidden');
        historySection.classList.remove('hidden');
        navNew.classList.remove('active');
        navHistory.classList.add('active');
        loadHistory();
      });
      if (startJournalLink) {
        startJournalLink.addEventListener('click', function(e) {
          e.preventDefault();
          navNew.click();
        });
      }
      // Journal form submission
      const form = document.getElementById('journal-form');
      const resultDiv = document.getElementById('result');
      const loadingDiv = document.getElementById('loading');
      const emotionLabel = document.getElementById('emotion-label');
      const emotionScore = document.getElementById('emotion-score');
      // Store entries in localStorage (simulating database)
      if (!localStorage.getItem('journalEntries')) {
        localStorage.setItem('journalEntries', JSON.stringify([]));
      }
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        const entryText = document.getElementById('journal-entry').value;
        if (!entryText) return;
        // Show loading
        loadingDiv.classList.remove('hidden');
        resultDiv.classList.add('hidden');
        // Simulate API call with timeout
        setTimeout(function() {
          // For demo purposes, we'll simulate the sentiment analysis
          // In a real application, this would call your Flask backend
          const emotions = [
            {label: 'joy', score: Math.random() * 0.5 + 0.5},
            {label: 'sadness', score: Math.random() * 0.3},
            {label: 'anger', score: Math.random() * 0.2},
            {label: 'fear', score: Math.random() * 0.2},
            {label: 'surprise', score: Math.random() * 0.1}
          ];
          // Get the emotion with the highest score
          const primaryEmotion = emotions.reduce((max, emotion) => 
            emotion.score > max.score ? emotion : max, emotions[0]);
          // Save entry to localStorage
          const entries = JSON.parse(localStorage.getItem('journalEntries'));
          entries.push({
            text: entryText,
            emotion: primaryEmotion.label,
            score: primaryEmotion.score,
            date: new Date().toISOString()
          });
          localStorage.setItem('journalEntries', JSON.stringify(entries));
          // Display results
          emotionLabel.textContent = primaryEmotion.label;
          emotionScore.textContent = (primaryEmotion.score * 100).toFixed(2) + '%';
          // Create emotion chart
          createEmotionChart(primaryEmotion.label, primaryEmotion.score, emotions);
          // Hide loading and show results
          loadingDiv.classList.add('hidden');
          resultDiv.classList.remove('hidden');
          // Clear the form
          document.getElementById('journal-entry').value = '';
        }, 1500); // Simulate API delay
      });
      // Function to create emotion chart
      function createEmotionChart(primaryEmotion, primaryScore, allEmotions) {
        const ctx = document.getElementById('emotion-chart').getContext('2d');
        // Define emotion colors
        const emotionColors = {
          'joy': '#4e73df',
          'sadness': '#36b9cc',
          'anger': '#e74a3b',
          'fear': '#f6c23e',
          'disgust': '#1cc88a',
          'surprise': '#6f42c1',
          'neutral': '#858796'
        };
        // Prepare data for chart
        const labels = allEmotions.map(e => e.label);
        const data = allEmotions.map(e => e.score * 100);
        const backgroundColors = allEmotions.map(e => emotionColors[e.label] || '#858796');
        // Create chart
        new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              data: data,
              backgroundColor: backgroundColors,
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return context.label + ': ' + context.raw.toFixed(2) + '%';
                  }
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                ticks: {
                  callback: function(value) {
                    return value + '%';
                  }
                }
              }
            }
          }
        });
      }
      // Function to load history
      function loadHistory() {
        const entriesList = document.getElementById('entries-list');
        const entries = JSON.parse(localStorage.getItem('journalEntries'));
        if (entries.length === 0) {
          entriesList.innerHTML = '<p>No entries yet. <a href="#" id="start-journal">Write your first journal entry</a>.</p>';
          if (document.getElementById('start-journal')) {
            document.getElementById('start-journal').addEventListener('click', function(e) {
              e.preventDefault();
              navNew.click();
            });
          }
          return;
        }
        // Clear previous entries
        entriesList.innerHTML = '';
        // Add entries to the list
        entries.reverse().forEach(entry => {
          const entryEl = document.createElement('div');
          entryEl.className = 'journal-entry';
          const date = new Date(entry.date);
          entryEl.innerHTML = `
            <div class="entry-date">${date.toLocaleDateString()} ${date.toLocaleTimeString()}</div>
            <div class="entry-text">${entry.text}</div>
            <div class="entry-sentiment">
              Emotion: <span class="emotion-tag">${entry.emotion}</span> (${(entry.score * 100).toFixed(2)}%)
            </div>
          `;
          entriesList.appendChild(entryEl);
        });
        // Create mood trend chart
        createMoodTrendChart(entries);
      }
      // Function to create mood trend chart
      function createMoodTrendChart(entries) {
        const ctx = document.getElementById('mood-trend-chart').getContext('2d');
        // Group entries by date and calculate average scores for each emotion
        const dates = {};
        entries.forEach(entry => {
          const date = new Date(entry.date).toLocaleDateString();
          if (!dates[date]) {
            dates[date] = {
              joy: { total: 0, count: 0 },
              sadness: { total: 0, count: 0 },
              anger: { total: 0, count: 0 },
              fear: { total: 0, count: 0 },
              surprise: { total: 0, count: 0 }
            };
          }
          if (dates[date][entry.emotion]) {
            dates[date][entry.emotion].total += entry.score;
            dates[date][entry.emotion].count += 1;
          }
        });
        // Prepare data for chart
        const labels = Object.keys(dates);
        const emotionData = {
          joy: [],
          sadness: [],
          anger: [],
          fear: [],
          surprise: []
        };
        labels.forEach(date => {
          Object.keys(emotionData).forEach(emotion => {
            if (dates[date][emotion] && dates[date][emotion].count > 0) {
              emotionData[emotion].push((dates[date][emotion].total / dates[date][emotion].count) * 100);
            } else {
              emotionData[emotion].push(0);
            }
          });
        });
        // Define emotion colors
        const emotionColors = {
          'joy': '#4e73df',
          'sadness': '#36b9cc',
          'anger': '#e74a3b',
          'fear': '#f6c23e',
          'surprise': '#6f42c1'
        };
        // Create chart
        new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels,
            datasets: Object.keys(emotionData).map(emotion => ({
              label: emotion,
              data: emotionData[emotion],
              backgroundColor: emotionColors[emotion],
              borderColor: emotionColors[emotion],
              fill: false,
              tension: 0.1
            }))
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                ticks: {
                  callback: function(value) {
                    return value + '%';
                  }
                }
              }
            }
          }
        });
      }
    });
  </script>
</body>
</html>